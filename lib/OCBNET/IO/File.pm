################################################################################
# Copyright 2014 by Marcel Greter
# This file is part of Webmerge (GPL3)
################################################################################
package OCBNET::IO::File;
################################################################################
use base qw(IO::File);
################################################################################

use strict;
use warnings;

################################################################################
################################################################################

sub open
{
	# get arguments
	my ($fh) = shift;
	# dispatch open (abort on error)
	my $rv = $fh->SUPER::open(@_) || return;
	# sniff the encoding for the css file
	my $encoding = $fh->sniff_encoding($_[0]);
	# store sniffed encoding on file node
	if ($fh && UNIVERSAL::can($fh, 'encoding'))
	{ $fh->encoding = $encoding if $encoding; }
	# return filehandle
	return $fh;
}

################################################################################
# handle encoding on glob
################################################################################

sub encoding : lvalue
{
	# get handle
	my $fh = $_[0];
	# store to glob
	${*$fh}{'encoding'};
}

################################################################################
use Encode qw();
################################################################################

# sub encode { \ Encode::encode($_[0]->encoding, ${$_[1]}) }
# sub decode { \ Encode::decode($_[0]->encoding, ${$_[1]}) }

################################################################################
################################################################################
1;
